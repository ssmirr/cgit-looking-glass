# Anubis environment configuration for cgit instance
# Loaded by systemd: anubis@cgit.service -> /etc/anubis/cgit.env

# Upstream — lighttpd running cgit
# Loopback only: cloudflared tunnel connects to this locally.
# Nothing is exposed to the public internet.
BIND=127.0.0.1:8923
TARGET=http://127.0.0.1:8080

# Proof-of-work difficulty (4 = default, raise if under heavy bot attack)
DIFFICULTY={{DIFFICULTY}}

# Bot policy file
POLICY_FNAME=/etc/anubis/cgit.botPolicies.yaml

# Cookie settings
COOKIE_DOMAIN={{DOMAIN}}
COOKIE_EXPIRATION_TIME=168h
COOKIE_SECURE=true

# Signing key — generated by setup.sh
ED25519_PRIVATE_KEY_HEX={{ED25519_KEY}}

# Use Cloudflare's real IP header
CUSTOM_REAL_IP_HEADER=CF-Connecting-IP

# Let Anubis serve robots.txt (deny AI crawlers)
SERVE_ROBOTS_TXT=true

# OG passthrough — allows link previews in chat apps/social media
OG_PASSTHROUGH=true

# Logging
SLOG_LEVEL=WARN

# Metrics — Prometheus endpoint (loopback only, not exposed via tunnel)
METRICS_BIND=127.0.0.1:9090
