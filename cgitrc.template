#
# cgitrc — generated by setup.sh
# Docs: https://git.zx2c4.com/cgit/tree/cgitrc.5.txt
#

# ---------------------------------------------------------------------------
# Global settings
# ---------------------------------------------------------------------------
virtual-root=/
css=/cgit.css
js=/cgit.js
logo=
favicon=/favicon.svg

# Header / footer for theme toggle
header=/etc/cgit/header.html
footer=/etc/cgit/footer.html

# Site chrome
root-title={{SITE_TITLE}}
root-desc=Public git repositories

# Repository owner
owner={{OWNER_NAME}}

# ---------------------------------------------------------------------------
# Clone URLs
# ---------------------------------------------------------------------------
clone-prefix={{CLONE_PREFIX}}

# ---------------------------------------------------------------------------
# Rendering
# ---------------------------------------------------------------------------
# Syntax highlighting — custom filter (CSS classes only, no inline styles)
# Works with our theme's .highlight CSS rules in both light and dark mode
source-filter=/etc/cgit/syntax-highlight.py
# Convert markdown readmes
about-filter=/usr/lib/cgit/filters/about-formatting.sh
# Gravatar / libravatar
email-filter=lua:/usr/lib/cgit/filters/email-libravatar.lua

# ---------------------------------------------------------------------------
# Feature toggles
# ---------------------------------------------------------------------------
# Read per-repo cgit.* config keys (desc, owner, section, etc.)
# Also removes the requirement for git-daemon-export-ok in each repo
enable-git-config=1

enable-index-owner=0
enable-index-links=1
enable-log-filecount=1
enable-log-linecount=1
enable-blame=1
enable-commit-graph=1
max-repo-count=50
max-repodesc-length=80

# Limit resource usage on constrained boxes
max-stats=quarter
max-diff-lines=3000
max-message-length=500
max-blob-size=512000

# ---------------------------------------------------------------------------
# Caching — critical for performance
# Tuned conservatively; setup.sh adjusts cache-size based on available RAM
# ---------------------------------------------------------------------------
cache-root={{CACHE_DIR}}
cache-size={{CACHE_SIZE}}

# Cache TTLs (seconds)
cache-repo-ttl=300
cache-dynamic-ttl=120
cache-static-ttl=900
cache-root-ttl=300

# ---------------------------------------------------------------------------
# Security
# ---------------------------------------------------------------------------
snapshots=tar.gz zip
noplainemail=1

# ---------------------------------------------------------------------------
# Repository scanning
# IMPORTANT: scan-path MUST be the last directive. When cgit parses it, it
# immediately registers repos — any global settings (source-filter, etc.)
# defined AFTER scan-path will NOT apply to the discovered repos.
# ---------------------------------------------------------------------------
scan-path={{REPOS_DIR}}

# ---------------------------------------------------------------------------
# Per-repo overrides go in each repo's config
# Example: git -C /srv/git/myrepo.git config cgit.desc "My project"
# ---------------------------------------------------------------------------
